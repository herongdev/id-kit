{"version":3,"sources":["pages/index/index.uvue"],"names":[],"mappings":"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","file":"pages/index/index.uvue","sourcesContent":["<template>\n  <view class=\"wrapper\">\n    <view class=\"actions\">\n      <button type=\"primary\" @click=\"onConsent\" :disabled=\"consent || loading\">\n        {{ consent ? '已同意' : '同意并初始化' }}\n      </button>\n      <button @click=\"onGetBest\" :disabled=\"!consent || loading\">获取最佳ID</button>\n    </view>\n\n    <view class=\"result\" v-if=\"hasResult\">\n      <text>来源：{{ result.source }}</text>\n      <text>可用：{{ result.available }}</text>\n      <text v-if=\"result.hash\">哈希：{{ result.hash }}</text>\n      <text v-if=\"result.value\">原值：{{ result.value }}</text>\n      <text v-if=\"result.message\">说明：{{ result.message }}</text>\n    </view>\n  </view>\n</template>\n\n<script>\nimport { register, setSalt, getBestId } from '@/uni_modules/id-kit'\n\nexport default {\n  data() {\n    return {\n      consent: false,\n      loading: false,\n      hasResult: false,\n      // 结果使用 UTSJSONObject，避免将原生 JSONObject 强转为自定义类型导致 ClassCastException\n      result: {} as UTSJSONObject\n    }\n  },\n  methods: {\n    async onConsent() {\n      this.loading = true\n      try {\n        await register({})\n        setSalt('demo-salt')\n        this.consent = true\n        uni.showToast({ title: '已同意' })\n      } catch (e) {\n        uni.showToast({ title: '初始化失败', icon: 'none' })\n      } finally {\n        this.loading = false\n      }\n    },\n    async onGetBest() {\n      this.loading = true\n      try {\n        // 原生返回 UTSJSONObject；按需拷贝到响应式 result\n        const best = (await getBestId({ exposeRaw: false })) as UTSJSONObject\n\n        // 为稳妥起见做一次空值兜底\n        this.result['source'] = (best['source'] ?? 'none') as string\n        this.result['available'] = (best['available'] === true)\n        this.result['hash'] = (best['hash'] ?? null) as (string | null)\n        this.result['value'] = (best['value'] ?? null) as (string | null)\n        this.result['limited'] = (best['limited'] ?? null) as (boolean | null)\n        this.result['message'] = (best['message'] ?? null) as (string | null)\n\n        this.hasResult = true\n      } catch (e) {\n        console.log('onGetBest error', e)\n        this.result = {} as UTSJSONObject\n        this.hasResult = true\n      } finally {\n        this.loading = false\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.wrapper {\n  padding: 24rpx;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n\n.actions {\n  display: flex;\n}\n\n.result {\n  display: flex;\n  flex-direction: column;\n}\n\n.logo {\n  height: 100px;\n  width: 100px;\n  margin: 100px auto 25px auto;\n}\n\n.title {\n  font-size: 18px;\n  color: #8f8f94;\n  text-align: center;\n}\n</style>\n"]}