{"version":3,"sources":["pages/index/index.uvue","App.uvue"],"sourcesContent":["<template>\n  <view class=\"wrapper\">\n    <view class=\"actions\">\n      <button type=\"primary\" @click=\"onConsent\" :disabled=\"consent || loading\">\n        {{ consent ? '已同意' : '同意并初始化' }}\n      </button>\n      <button @click=\"onGetBest\" :disabled=\"!consent || loading\">获取最佳ID</button>\n    </view>\n\n    <view class=\"result\" v-if=\"hasResult\">\n      <text>来源：{{ result.source }}</text>\n      <text>可用：{{ result.available }}</text>\n      <text v-if=\"result.hash\">哈希：{{ result.hash }}</text>\n      <text v-if=\"result.value\">原值：{{ result.value }}</text>\n      <text v-if=\"result.message\">说明：{{ result.message }}</text>\n    </view>\n  </view>\n</template>\n\n<script>\nimport { register, setSalt, getBestId } from '@/uni_modules/id-kit'\n\nexport default {\n  data() {\n    return {\n      consent: false,\n      loading: false,\n      hasResult: false,\n      // 结果使用 UTSJSONObject，避免将原生 JSONObject 强转为自定义类型导致 ClassCastException\n      result: {} as UTSJSONObject\n    }\n  },\n  methods: {\n    async onConsent() {\n      this.loading = true\n      try {\n        await register({})\n        setSalt('demo-salt')\n        this.consent = true\n        uni.showToast({ title: '已同意' })\n      } catch (e) {\n        uni.showToast({ title: '初始化失败', icon: 'none' })\n      } finally {\n        this.loading = false\n      }\n    },\n    async onGetBest() {\n      this.loading = true\n      try {\n        // 原生返回 UTSJSONObject；按需拷贝到响应式 result\n        const best = (await getBestId({ exposeRaw: false })) as UTSJSONObject\n\n        // 为稳妥起见做一次空值兜底\n        this.result['source'] = (best['source'] ?? 'none') as string\n        this.result['available'] = (best['available'] === true)\n        this.result['hash'] = (best['hash'] ?? null) as (string | null)\n        this.result['value'] = (best['value'] ?? null) as (string | null)\n        this.result['limited'] = (best['limited'] ?? null) as (boolean | null)\n        this.result['message'] = (best['message'] ?? null) as (string | null)\n\n        this.hasResult = true\n      } catch (e) {\n        console.log('onGetBest error', e)\n        this.result = {} as UTSJSONObject\n        this.hasResult = true\n      } finally {\n        this.loading = false\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\">\n.wrapper {\n  padding: 24rpx;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n\n.actions {\n  display: flex;\n}\n\n.result {\n  display: flex;\n  flex-direction: column;\n}\n\n.logo {\n  height: 100px;\n  width: 100px;\n  margin: 100px auto 25px auto;\n}\n\n.title {\n  font-size: 18px;\n  color: #8f8f94;\n  text-align: center;\n}\n</style>\n",null],"names":[],"mappings":"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"}